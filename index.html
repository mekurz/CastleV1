<!DOCTYPE html> 
<html>
	<head>
		<title>BROWSER OF THE WINDS</title>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<link href="css/overcast/jquery-ui-1.10.1.custom.min.css" rel="stylesheet" type="text/css"/>
		<link href="css/bootstrap.min.css" rel="stylesheet" type="text/css" />
		<link href="css/chosen.css" rel="stylesheet" type="text/css" />
		<link href="css/style.css" rel="stylesheet" type="text/css" />
		<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
		<script src="http://code.jquery.com/jquery-migrate-1.1.1.js"></script>
		<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.1/jquery-ui.min.js"></script>
		<script type="text/javascript" src="libs/bootstrap.min.js"></script>
		<script type="text/javascript" src="libs/chosen.jquery.min.js"></script>
		<script type="text/javascript" src="libs/jstorage.min.js"></script>
		<script type="text/javascript" src="storage.js"></script>
		<script type="text/javascript" src="common.js"></script>
		<script type="text/javascript" src="logger.js"></script>
		<script type="text/javascript" src="data_loader.js"></script>
		<script type="text/javascript" src="image_cache.js"></script>
		<script type="text/javascript" src="game.js"></script>
		<script type="text/javascript" src="viewport.js"></script>
		<script type="text/javascript" src="actor.js"></script>
		<script type="text/javascript" src="mouse.js"></script>
		<script type="text/javascript" src="movement.js"></script>
		<script type="text/javascript" src="monsters.js"></script>
		<script type="text/javascript" src="spells.js"></script>
		<script type="text/javascript" src="melee.js"></script>
		<script type="text/javascript" src="debug.js"></script>
		<script type="text/javascript" src="MapGen/mapgen.js"></script>
		<script type="text/javascript" src="inventory.js"></script>
		<script type="text/javascript" src="paperdoll.js"></script>
		<script type="text/javascript" src="level.js"></script>
		<script type="text/javascript" src="verbs.js"></script>
		<script type="text/javascript" src="widget.js"></script>
		<script type="text/javascript" src="minimap.js"></script>
		<script type="text/javascript" src="traps.js"></script>
		<script type="text/javascript" src="spellbook.js"></script>
		<script type="text/javascript" src="new_game.js"></script>
		<script type="text/javascript" src="char_info.js"></script>
		<script type="text/javascript" src="status_effects.js"></script>
	</head>
	<body style="margin:0px;">
	  Use arrows or num pad to move, OR click and drag the man to move. Click on RAT MANS or bump into them to attack! Select a spell from the menu, click Cast and then click a tile!<br/>
		processing:<input type="text" id="processing" value="0" style="width:3em;"></input>
		command:<input type="text" id="command" value="0" style="width:3em;"></input>
		<a href="changelog.txt">Change Log</a> | <a href="MapGen/test.html">Map Generator</a> | <a href="test/test.html">Unit Tests</a> | <a href="TPOC/ItemsTPOC/test.html">Item Effect TPOC</a> | <a href="TPOC/ImageCombiner/combiner.html">Combiner</a> |
		TEST: <select id="test_menu">
		  <option value="0">TEST FIZZLES</option>
		  <option value="1">TEST SPLAT</option>
		  <option value="2">TEST PROJECTILES</option>
		  <option value="3">TEST AREA EFFECT</option>
		  <option value="6">TEST CONES</option>
		  <option value="7">TEST DIAGONAL CONES</option>
		  <option value="-1">------------------</option>
      <option value="4">KILL ALL MONSTERS</option>
      <option value="5">DO TURN</option>
		  <option value="8">REVEAL MAP</option>
		  <option value="10">REVEAL SECRET DOORS</option>
		  <option value="12">REVEAL TRAPS</option>
		  <option value="9">GAME OVER MAN</option>
		  <option value="11">ERASE LOCALSTORAGE</option>
		  <option value="13">LEARN ALL SPELLS</option>
		  <option value="14">TEST STATUS EFFECT</option>
		  <option value="15">TEST WEAK POISON</option>
		  <option value="16">TEST MINOR POISON</option>
		</select>
		<input type="submit" value="Run Test" onclick="run_test();"></input>
		<br/>
		SPELL: <select id="spell_menu">
      <option value="p1">MAGIC MISSILE</option>
      <option value="p2">LIGHTNING BOLT</option>
      <option value="p3">FIREBOLT</option>
      <option value="a1">FIREBALL</option>
      <option value="p4">BOULDER</option>
      <option value="c1">FIRE BREATH</option>
      <option value="u1">LIGHT</option>
      <option value="u2">DIMENSION DOOR</option>
    </select>
		<input type="submit" value="Cast Spell" onclick="cast_spell_by_id( $('#spell_menu').val() );"></input>
		<input type="submit" value="Switch to Random Map" onclick="random_map();"></input>
		<div id="game_area" style="margin-left:10px;position:relative;line-height:normal;">
			<div class="btn-toolbar">
	      <div class="btn-group">
	        <button class="btn btn-text dropdown-toggle" data-toggle="dropdown">Game <b class="caret"></b></button>
	        <ul class="dropdown-menu">
	          <li><a href="#new_game" role="button" data-toggle="modal">New Game...</a></li>
	          <li class="divider"></li>
	          <li><a href="#" onclick="Storage.open_load();">Load Game...</a></li>
	          <li><a id="save_game" href="#" onclick="Storage.open_save();">Save Game...</a></li>
	          <li class="divider"></li>
	          <li><a href="#shortcuts" role="button" data-toggle="modal">Shortcuts...</a></li>
	          <li><a href="#" onclick="Log.clear();">Clear Log</a></li>
	          <li><a href="#debug_flags" role="button" data-toggle="modal">Debug Flags...</a></li>
	        </ul>
	      </div>
	      <div id="verbs_bar" class="btn-group">
	        <button id="btn_inventory" class="btn btn-text" onclick="Inventory.open();">Inventory</button>
	        <button id="btn_map" class="btn btn-text" onclick="Minimap.open();">Map</button>
	        <button id="btn_search" class="btn btn-text" onclick="perform_action('search');">Search</button>
	        <button id="btn_disarm" class="btn btn-text" onclick="perform_action('disarm');">Disarm</button>
	        <button id="btn_take" class="btn btn-text" onclick="perform_action('take');">Take</button>
	        <button id="btn_verbs" class="btn btn-text dropdown-toggle" data-toggle="dropdown">More <b class="caret"></b></button>
	        <ul id="other_actions_menu" class="dropdown-menu pull-right">
	          <li><a href="#" onclick="perform_action('open');">Open</a></li>
	          <li><a href="#" onclick="perform_action('close');">Close</a></li>
	          <li><a href="#" onclick="perform_action('rest');">Rest Until Healed</a></li>
	          <li><a href="#" onclick="perform_action('sleep');">Sleep Until Mana is Restored</a></li>
	          <li><a href="#" onclick="perform_action('up');">Climb Up Stairs</a></li>
	          <li><a href="#" onclick="perform_action('down');">Climb Down Stairs</a></li>
	        </ul>
	      </div>     
	      <div id="spell_bar" class="btn-group">
	        <button id="spell0" class="btn btn-img" onclick="cast_spell(0);"></button>
          <button id="spell1" class="btn btn-img" onclick="cast_spell(1);"></button>
          <button id="spell2" class="btn btn-img" onclick="cast_spell(2);"></button>
          <button id="spell3" class="btn btn-img" onclick="cast_spell(3);"></button>
          <button id="spell4" class="btn btn-img" onclick="cast_spell(4);"></button>
          <button id="spell5" class="btn btn-img" onclick="cast_spell(5);"></button>
          <button id="spell6" class="btn btn-img" onclick="cast_spell(6);"></button>
          <button class="btn btn-img dropdown-toggle" data-toggle="dropdown"><img src="images/gear.png" /> <b class="caret"></b></button>
	        <ul id="other_actions_menu" class="dropdown-menu pull-right">
	          <li><a href="#char_info" role="button" data-toggle="modal">Character Info...</a></li>
	          <li><a href="#customize_spells" role="button" data-toggle="modal">Customize Spell Menu...</a></li>
	        </ul>
	      </div>
	    </div>
      <canvas id="map" width="960" height="480" style="border:1px solid black;" oncontextmenu="return false;">
			  Canvas not supported. You must be using Internet Explorer 9, Firefox 4+, Chrome or Safari.
			</canvas>
			<div id="log" class="Information" style="width:810px;height:150px;"></div>
			<div id="stats" class="Information" style="width:143px;height:144px;border-left-width:0px;padding:3px;">
			  <div style="height:60px;">
				  <span class="StatName">Hit Points</span>
				  <span id="hp" class="Stat"></span><br/>
				  <span class="StatName">Mana</span>
				  <span id="mana" style="float:right;color:blue;"></span><br/>
				  <span class="StatName">Time</span>
	        <span id="time" class="Stat"></span>
	        <span class="StatName">Dungeon Level</span>
	        <span id="level" class="Stat"></span>
        </div>
        <div id="effects" class="clearfix"></div>
			</div>
		  <div id="load_div">
		    Loading...
		    <div class="progress progress-striped active" style="width:180px;margin:auto;">
          <div id="load_bar" class="bar" style="width:0%;"></div>
        </div>
        <span id="load_pct"></span>%
		  </div>
		  <div id="tooltip">
        <div id="tooltip_header"></div>
        <ul id="tooltip_contents"></ul>
      </div>
		  
		  <div id="shortcuts" class="modal hide" tabindex="-1" role="dialog">
			  <div class="modal-header">
			    <button type="button" class="close" data-dismiss="modal">&times;</button>
			    <h3>Keyboard Shortcuts</h3>
			  </div>
			  <div class="modal-body">
			    <!--  shortcuts.html  -->
			  </div>
			  <div class="modal-footer">
			    <button class="btn btn-primary" data-dismiss="modal">Close</button>
			  </div>
			</div>
			
			<div id="debug_flags" class="modal hide" tabindex="-1" role="dialog">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h3>Debug Flags</h3>
        </div>
        <div class="modal-body">
          <label class="checkbox"><input type="checkbox" id="debugmode" onclick="DEBUGGING = this.checked;"/> Debug mode</label>
          <label class="checkbox"><input type="checkbox" id="freeze"    onclick="FREEZE_MONSTERS = this.checked;"/> Freeze monster movement</label>
          <label class="checkbox"><input type="checkbox" id="mspells"   onclick="MONSTER_SPELLS = this.checked;"/> Monsters can cast spells</label>
          <label class="checkbox"><input type="checkbox" id="detect"    onclick="DETECT_MONSTERS = this.checked;"/> Detect monsters</label>
        </div>
        <div class="modal-footer">
          <button class="btn btn-primary" data-dismiss="modal">Close</button>
        </div>
      </div>

	    <div id="inventory" class="modal hide" tabindex="-1" role="dialog" style="width:auto;">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h3>Inventory</h3>
        </div>
        <div class="modal-body" style="max-height:none;">
          <!-- inventory.html -->
        </div>
        <div class="modal-footer">
          <button class="btn btn-primary" data-dismiss="modal">Close</button>
        </div>
      </div>
	    
      <div id="minimap_popup" class="modal hide" tabindex="-1" role="dialog" style="width:auto;">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h3>Map</h3>
        </div>
        <div class="modal-body" style="max-height:none;padding:0px">
          <canvas id="minimap" width="600" height="600" oncontextmenu="return false;"></canvas>
        </div>
        <div class="modal-footer">
          <button class="btn btn-primary" data-dismiss="modal">Close</button>
        </div>
      </div>
      
      <div id="storage" class="modal hide" tabindex="-1" role="dialog" style="width:auto;">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h3 id="storage_title">Storage</h3>
        </div>
        <div class="modal-body">
          <!--  storage.html  -->
        </div>
        <div class="modal-footer">
          <button class="btn" data-dismiss="modal">Cancel</button>
          <button id="storage_ok" class="btn btn-primary" onclick="Storage.ok();">Save changes</button>
        </div>
      </div>
			
			<div id="customize_spells" class="modal hide" tabindex="-1" role="dialog" style="width:auto;overflow:visible;">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h3>Customize Spell Menu</h3>
        </div>
        <div class="modal-body" style="overflow:visible;">
          <!--  spellbook.html  -->
        </div>
        <div class="modal-footer">
          <button class="btn" data-dismiss="modal">Cancel</button>
          <button class="btn btn-primary" onclick="CustomizeSpellBar.ok();">Save changes</button>
        </div>
      </div>
      
      <div id="new_game" class="modal hide" tabindex="-1" role="dialog" style="width:auto;overflow:visible;">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h3>New Game</h3>
        </div>
        <div class="modal-body" style="overflow:visible;">
          <!--  new_game.html  -->
        </div>
        <div class="modal-footer">
          <button class="btn" data-dismiss="modal">Cancel</button>
          <button id="storage_ok" class="btn btn-primary" onclick="NewGame.ok();">Start game!</button>
        </div>
      </div>
      
      <div id="char_info" class="modal hide" tabindex="-1" role="dialog" style="width:auto;">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h3>Character Information</h3>
        </div>
        <div class="modal-body">
          <!--  character_info.html  -->
        </div>
        <div class="modal-footer">
          <button class="btn btn-primary" data-dismiss="modal">Close</button>
        </div>
      </div>

		</div>
	  <script type="text/javascript">
		  $(document).ready( function()
		  {
		    $(".btn-group").button();
		    
		    $("#shortcuts").modal({ 
		              show: false,
		              remote: "html/shortcuts.html"
		         });
		    $("#shortcuts").on( "show", open_dialog );
		    $("#shortcuts").on( "hide", close_dialog );
		    
		    $("#debug_flags").modal({ 
                  show: false
             });
        $("#debug_flags").on( "show", open_dialog );
        $("#debug_flags").on( "hide", close_dialog );
		     
	      $("#debugmode").prop( "checked", DEBUGGING );
	      $("#freeze").prop( "checked", FREEZE_MONSTERS );
	      $("#mspells").prop( "checked", MONSTER_SPELLS );
	      $("#detect").prop( "checked", DETECT_MONSTERS );
	    
	      document.game = new Game();
        document.game.run(1);
        
        set_command( NO_COMMAND );
        set_finished();
	    });
	  </script>
	</body>
</html>