<!DOCTYPE html> 
<html>
	<head>
		<title>BROWSER OF THE WINDS</title>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<link href="css/overcast/jquery-ui-1.8.22.custom.css" rel="stylesheet" type="text/css"/>
		<link href="css/bootstrap.min.css" rel="stylesheet" type="text/css" />
		<link href="css/style.css" rel="stylesheet" type="text/css" />
		<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
		<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.21/jquery-ui.min.js"></script>
		<script type="text/javascript" src="libs/bootstrap.min.js"></script>
		<script type="text/javascript" src="libs/jstorage.js"></script>
		<script type="text/javascript" src="storage.js"></script>
		<script type="text/javascript" src="common.js"></script>
		<script type="text/javascript" src="logger.js"></script>
		<script type="text/javascript" src="data_loader.js"></script>
		<script type="text/javascript" src="image_cache.js"></script>
		<script type="text/javascript" src="game.js"></script>
		<script type="text/javascript" src="viewport.js"></script>
		<script type="text/javascript" src="actor.js"></script>
		<script type="text/javascript" src="mouse.js"></script>
		<script type="text/javascript" src="movement.js"></script>
		<script type="text/javascript" src="monsters.js"></script>
		<script type="text/javascript" src="spells.js"></script>
		<script type="text/javascript" src="melee.js"></script>
		<script type="text/javascript" src="debug.js"></script>
		<script type="text/javascript" src="MapGen/mapgen.js"></script>
		<script type="text/javascript" src="inventory.js"></script>
		<script type="text/javascript" src="paperdoll.js"></script>
		<script type="text/javascript" src="level.js"></script>
		<script type="text/javascript" src="verbs.js"></script>
		<script type="text/javascript" src="widget.js"></script>
		<script type="text/javascript" src="minimap.js"></script>
		<script type="text/javascript" src="traps.js"></script>
		<script type="text/javascript" src="spellbook.js"></script>
		<script type="text/javascript" src="new_game.js"></script>
	</head>
	<body style="margin:0px;">
	  Use arrows or num pad to move, OR click and drag the man to move. Click on RAT MANS or bump into them to attack! Select a spell from the menu, click Cast and then click a tile!<br/>
		processing:<input type="text" id="processing" value="0" style="width:3em;"></input>
		command:<input type="text" id="command" value="0" style="width:3em;"></input>
		<a href="changelog.txt">Change Log</a> | <a href="MapGen/test.html">Map Generator</a> | <a href="ItemsTPOC/test.html">Item Effect TPOC</a> | 
		TEST: <select id="test_menu">
		  <option value="0">TEST FIZZLES</option>
		  <option value="1">TEST SPLAT</option>
		  <option value="2">TEST PROJECTILES</option>
		  <option value="3">TEST AREA EFFECT</option>
		  <option value="6">TEST CONES</option>
		  <option value="7">TEST DIAGONAL CONES</option>
		  <option value="-1">------------------</option>
      <option value="4">KILL ALL RAT MANS</option>
      <option value="5">DO TURN</option>
		  <option value="8">REVEAL MAP</option>
		  <option value="10">REVEAL SECRET DOORS</option>
		  <option value="12">REVEAL TRAPS</option>
		  <option value="9">GAME OVER MAN</option>
		  <option value="11">ERASE LOCALSTORAGE</option>
		</select>
		<input type="submit" value="Run Test" onclick="run_test();"></input>
		<br/>
		SPELL: <select id="spell_menu">
      <option value="p1">MAGIC MISSILE</option>
      <option value="p2">LIGHTNING BOLT</option>
      <option value="p3">FIREBOLT</option>
      <option value="a1">FIREBALL</option>
      <option value="p4">BOULDER</option>
      <option value="c1">FIRE BREATH</option>
      <option value="u1">LIGHT</option>
    </select>
		<input type="submit" value="Cast Spell" onclick="cast_spell_by_id( $('#spell_menu').val() );"></input>
		<input type="submit" value="Switch to Random Map" onclick="random_map();"></input>
		<div id="game_area" style="margin-left:10px;position:relative;line-height:normal;">
			<div class="btn-toolbar">
	      <div class="btn-group">
	        <button class="btn btn-large dropdown-toggle" data-toggle="dropdown">Game <b class="caret"></b></button>
	        <ul class="dropdown-menu">
	          <li><a href="#" onclick="NewGame.open();">New Game...</a></li>
	          <li class="divider"></li>
	          <li><a href="#" onclick="Storage.open_load();">Load Game...</a></li>
	          <li><a href="#" onclick="Storage.open_save();">Save Game...</a></li>
	          <li class="divider"></li>
	          <li><a href="#shortcuts" role="button" data-toggle="modal">Shortcuts...</a></li>
	          <li><a href="#" onclick="Log.clear();">Clear Log</a></li>
	          <li><a href="#debug_flags" role="button" data-toggle="modal">Debug Flags...</a></li>
	        </ul>
	      </div>
	      <div class="btn-group">
	        <button id="btn_inventory" class="btn btn-large" onclick="Inventory.open();">Inventory</button>
	        <button id="btn_map" class="btn btn-large" onclick="Minimap.open();">Map</button>
	        <button id="btn_search" class="btn btn-large" onclick="perform_action('search');">Search</button>
	        <button id="btn_disarm" class="btn btn-large" onclick="perform_action('disarm');">Disarm</button>
	        <button id="btn_take" class="btn btn-large" onclick="Log.add('TODO');">Take</button>
	        <button id="btn_verbs" class="btn btn-large dropdown-toggle" data-toggle="dropdown">More <b class="caret"></b></button>
	        <ul id="other_actions_menu" class="dropdown-menu pull-right">
	          <li><a href="#" onclick="perform_action('open');">Open</a></li>
	          <li><a href="#" onclick="perform_action('close');">Close</a></li>
	          <li><a href="#" onclick="perform_action('rest');">Rest Until Healed</a></li>
	          <li><a href="#" onclick="perform_action('sleep');">Sleep Until Mana is Restored</a></li>
	          <li><a href="#" onclick="perform_action('up');">Climb Up Stairs</a></li>
	          <li><a href="#" onclick="perform_action('down');">Climb Down Stairs</a></li>
	        </ul>
	      </div>     
	      <div class="btn-group">
	        <button id="spell0" class="btn btn-img" onclick="cast_spell(0);"></button>
	        <button id="spell1" class="btn btn-img" onclick="cast_spell(1);"></button>
	        <button id="spell2" class="btn btn-img" onclick="cast_spell(2);"></button>
	        <button id="spell3" class="btn btn-img" onclick="cast_spell(3);"></button>
	        <button id="spell4" class="btn btn-img" onclick="cast_spell(4);"></button>
	        <button id="spell5" class="btn btn-img" onclick="cast_spell(5);"></button>
	        <button id="spell6" class="btn btn-img" onclick="cast_spell(6);"></button>
	        <button class="btn dropdown-toggle btn-img" data-toggle="dropdown"><img src="images/gear.png"/> <b class="caret"></b></button>
	        <ul id="other_actions_menu" class="dropdown-menu pull-right">
	          <li><a href="#" onclick="CustomizeSpellBar.open();">Customize...</a></li>
	        </ul>
	      </div>
	    </div>
      <canvas id="map" width="960" height="480" style="border:1px solid black;" oncontextmenu="return false;">
			  Canvas not supported. You must be using Internet Explorer 9, Firefox 4+, Chrome or Safari.
			</canvas>
			<div id="log" class="Information" style="width:810px;height:150px;"></div>
			<div id="stats" class="Information" style="width:143px;height:144px;border-left-width:0px;padding:3px;">
			  <span class="StatName">Hit Points</span>
			  <span id="hp" style="float:right;"></span><br/>
			  <span class="StatName">Mana</span>
			  <span id="mana" style="float:right;color:blue;"></span><br/>
			  <span class="StatName">Time</span>
        <span id="time" style="float:right;"></span>
        <span class="StatName">Dungeon Level</span>
        <span id="level" style="float:right;"></span>
			</div>
		  <div id="load_div">
		    Loading...
		    <div class="progress progress-striped active" style="width:180px;margin:auto;">
          <div id="load_bar" class="bar" style="width:0%;"></div>
        </div>
        <span id="load_pct"></span>%
		  </div>
		  <div id="tooltip">
        <div id="tooltip_header"></div>
        <ul id="tooltip_contents"></ul>
      </div>
		  
		  <div id="shortcuts" class="modal hide" tabindex="-1" role="dialog">
			  <div class="modal-header">
			    <button type="button" class="close" data-dismiss="modal">&times;</button>
			    <h3>Keyboard Shortcuts</h3>
			  </div>
			  <div class="modal-body">
			    <!--  shortcuts.html  -->
			  </div>
			  <div class="modal-footer">
			    <button class="btn btn-primary" data-dismiss="modal">Close</button>
			  </div>
			</div>
			
			<div id="debug_flags" class="modal hide" tabindex="-1" role="dialog">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h3>Debug Flags</h3>
        </div>
        <div class="modal-body">
          <label class="checkbox"><input type="checkbox" id="debugmode" onclick="DEBUGGING = this.checked;"/> Debug mode</label>
          <label class="checkbox"><input type="checkbox" id="freeze"    onclick="FREEZE_MONSTERS = this.checked;"/> Freeze monster movement</label>
          <label class="checkbox"><input type="checkbox" id="mspells"   onclick="MONSTER_SPELLS = this.checked;"/> Monsters can cast spells</label>
          <label class="checkbox"><input type="checkbox" id="detect"    onclick="DETECT_MONSTERS = this.checked;"/> Detect monsters</label>
        </div>
        <div class="modal-footer">
          <button class="btn btn-primary" data-dismiss="modal">Close</button>
        </div>
      </div>

	    <div id="inventory" class="modal hide" tabindex="-1" role="dialog" style="width:auto;">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h3>Inventory</h3>
        </div>
        <div class="modal-body" style="max-height:none;">
          <!-- inventory.html -->
        </div>
        <div class="modal-footer">
          <button class="btn btn-primary" data-dismiss="modal">Close</button>
        </div>
      </div>
	    
      <div id="minimap_popup" class="modal hide" tabindex="-1" role="dialog" style="width:auto;">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h3>Map</h3>
        </div>
        <div class="modal-body" style="max-height:none;padding:0px">
          <canvas id="minimap" width="600" height="600" oncontextmenu="return false;"></canvas>
        </div>
        <div class="modal-footer">
          <button class="btn btn-primary" data-dismiss="modal">Close</button>
        </div>
      </div>
      
      
      <div id="storage">
        <div id="new_save_div">
          <div style="padding-bottom:5px;">
            Enter a description for a new saved game or select an existing save to overwrite.<br/>
  		      Up to three saved games are allowed.
  		    </div>
  		    <div class="br"></div>
				  <input type="text" id="new_save_desc" maxlength="35" style="width:460px;" placeholder="Enter a description"></input>
				  <button id="new_save_btn" class="btn" onclick="Storage.new_save();">New Save</button>
          <hr/>
				</div>
        <ol id="stored_games"></ol>
        <div id="no_games_msg">No saved games are present.</div>
			</div>
			
			<div id="customize_spells" class="modal hide" tabindex="-1" role="dialog">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h3>Customize Spell Menu</h3>
        </div>
        <div class="modal-body">
          <!--  spellbook.html  -->
        </div>
        <div class="modal-footer">
          <button class="btn" data-dismiss="modal">Cancel</button>
          <button class="btn btn-primary" onclick="CustomizeSpellBar.ok();">Save changes</button>
        </div>
      </div>
			
			<div id="new_game" title="New Game">
			  1. Choose a name <input type="text" id="char_name" maxlength="30" placeholder="Rock McSlab" style="width:250px"></input>
        <hr/>
        2. Assign character statistics
        <div style="margin-top:10px;">
	        <div class="StatBar Rounded" style="width:100px;height:170px;">
	          <span class="StatLabel">Remaining<br/>Points</span>
			      <div class="v-progress short" style="margin-top:5px;">
			        <div id="ng_pool" title="Remaining Points" class="bar green"></div>
			      </div>
			    </div>
			    <div class="StatBar">
			      <span class="StatLabel">Strength</span><br/>
            <button class="btn plus" onclick="NewGame.plus('str');">+</button>
            <div class="v-progress short">
              <div id="ng_str" title="Strength" class="bar green"></div>
            </div>
            <button class="btn minus" onclick="NewGame.minus('str');">&#8722;</button>
          </div>
          <div class="StatBar">
            <span class="StatLabel">Intelligence</span><br/>
            <button class="btn plus" onclick="NewGame.plus('int');">+</button>
            <div class="v-progress short">
              <div id="ng_int" title="Intelligence" class="bar green"></div>
            </div>
            <button class="btn minus" onclick="NewGame.minus('int');">&#8722;</button>
          </div>
          <div class="StatBar">
            <span class="StatLabel">Dexterity</span><br/>
            <button class="btn plus" onclick="NewGame.plus('dex');">+</button>
            <div class="v-progress short">
              <div id="ng_dex" title="Dexterity" class="bar green"></div>
            </div>
            <button class="btn minus" onclick="NewGame.minus('dex');">&#8722;</button>
          </div>
          <div class="StatBar">
            <span class="StatLabel">Constitution</span><br/>
            <button class="btn plus" onclick="NewGame.plus('con');">+</button>
            <div class="v-progress short">
              <div id="ng_con" title="Constitution" class="bar green"></div>
            </div>
            <button class="btn minus" onclick="NewGame.minus('con');">&#8722;</button>
          </div>
		    </div>
        <hr style="clear:left;"/>
        3. Choose 3 spells to learn  
      </div>
		</div>

		
	  <script type="text/javascript">
		  $(document).ready( function()
		  {
		    $(".btn-group").button();
		    
		    $("#shortcuts").modal({ 
		              show: false,
		              remote: "html/shortcuts.html"
		         });
		    $("#shortcuts").on( "show", open_dialog );
		    $("#shortcuts").on( "hide", close_dialog );
		    
		    $("#debug_flags").modal({ 
                  show: false
             });
        $("#debug_flags").on( "show", open_dialog );
        $("#debug_flags").on( "hide", close_dialog );
		     
	      $("#debugmode").prop( "checked", DEBUGGING );
	      $("#freeze").prop( "checked", FREEZE_MONSTERS );
	      $("#mspells").prop( "checked", MONSTER_SPELLS );
	      $("#detect").prop( "checked", DETECT_MONSTERS );
	    
	      document.game = new Game();
        document.game.run(1);
        
        set_command( NO_COMMAND );
        set_finished();
	    });
	  </script>
	</body>
</html>