
<html>
  <head>
    <title>BROWSER OF THE WINDS CANVAS VERSION - Inventory Test</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <link href="style.css" rel="stylesheet" type="text/css" />
    <link type="text/css" href="css/overcast/jquery-ui-1.8.16.custom.css" rel="Stylesheet" />
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js"></script>
    <style>
      .Item { width:48px;height:48px;border:1px solid blue;float:left;margin:1px;background:white;zIndex=100; }
      .BlankSlotItem { display:none; }
    </style>
  </head>
  <body>
    <button id="launch">Inventory</button>
    
    <div id="dialog" title="Inventory">
      Bag:
		  <div id="bag" style="border:1px solid black;margin-bottom:10px;height:104px;overflow:auto" class="ItemContainer"></div>
		  Equipped:
		  <div id="gear" style="border:1px solid black;margin-bottom:10px;height:104px;overflow:auto">
		    <div style="float:left;margin-left:5px">
		      1:<div id="Slot1" style="border:1px dashed black;width:52px;height:52px;" class="ItemContainer"></div>
		    </div>
		    <div style="float:left;margin-left:5px">
          10 or 15:<div id="Slot2" style="border:1px dashed black;width:52px;height:52px;" class="ItemContainer"></div>
        </div>
		  </div>
		  Floor:
      <div id="floor" style="border:1px solid black;margin-bottom:10px;height:104px;overflow:auto" class="ItemContainer">
      </div>
		</div>
    
    <script type="text/javascript">
      $(document).ready( function()
        {
	        $( "#dialog" ).dialog({ autoOpen: false,
	                                resizable: false,
	                                modal: true,
	                                width: 500,
	                                height: 500,
	                              });
	        
	        $("#launch").button().click( function(){
	             $( "#dialog" ).dialog("open");
	           });
	        
	        for( var ix = 1; ix <= 20; ix++ )
	        {
	         $("#bag").append( "<div id='item" + ix + "' class='Item'>" + ix + "</div>" ); 
	        }
	        
	        $("#item1").addClass( "Slot1" );
	        $("#item10").addClass( "Slot2" );
	        $("#item15").addClass( "Slot2" );
	        
	        $("#bag").sortable({ items: ".Item",
	                             placeholder: "BlankSlotItem",
	                             connectWith: ".ItemContainer",
	                             tolerance: "pointer",
	                             cursor: "move"
	          });
	        
	        $("#floor").sortable({ items: ".Item",
                               placeholder: "BlankSlotItem",
                               connectWith: ".ItemContainer",
                               tolerance: "pointer",
                               cursor: "move"
            });
	        
	        $("#Slot1").sortable({ items: ".Item",
                               placeholder: "BlankSlotItem",
                               connectWith: ".ItemContainer",
                               tolerance: "pointer",
                               cursor: "move",
                               receive: function(event, ui) {
															            var $this = $(this);
															            if( $this.children().length > 1 || !$(ui.item).hasClass( $this.attr("id") ) ) {
															                $(ui.sender).sortable("cancel");
															            }
				                                }
            });
	        
	        $("#Slot2").sortable({ items: ".Item",
                               placeholder: "BlankSlotItem",
                               connectWith: ".ItemContainer",
                               tolerance: "pointer",
                               cursor: "move",
                               receive: function(event, ui) {
                                          var $this = $(this);
                                          if( !$(ui.item).hasClass( $this.attr("id") ) ) // Doesn't belong in this slot
                                          {
                                            $(ui.sender).sortable("cancel");
                                          }
                                          else if( $this.children().length > 1 ) // Already something here, so perform a swap
                                          {
                                            var item = $this.children( "div:not(#" + ui.item[0].id + ")" ).detach();
                                            $(ui.sender).append( item );
                                          }
                                        }
            });
	        
        });
    </script>  
  </body>
</html>

